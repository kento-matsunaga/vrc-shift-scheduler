# 概要

本業務は、キャスト・スタッフが「出勤可能な日・時間帯・ポジション」を事前に申告するルールを定義する。これにより、運営は希望情報に基づいてシフト案を作成できる。

従来の「調整さん」のような仕組みでは、「出られるか出られないか」程度の情報しか扱えないことが多く、ポジションの希望や優先度を十分に表現できない。本業務では、希望日程・希望ポジション・優先度を含めた構造化された希望情報を扱う。

# 主要な概念

## シフト希望（ShiftAvailability）

メンバーが特定の営業日に対して提出する「出勤可能」の申告である。

- 対象営業日
- 対象インスタンス（第一インスタンスのみ希望などがあれば）
- 出勤可能時間帯（営業時間全体か、一部時間だけか）
- 希望ポジション（IL希望、カウンター優先など）
- 希望の強さ（必ず出たい／出られたら出たい など）

## 希望期間（AvailabilityPeriod）

まとめてシフト希望を提出する単位の期間である。

- 例：12月通常営業分、Vket特別営業分
- 従来「調整さん」の1枚に該当するものを、システム上で表現する。

# 制約条件

## 業務制約1：提出期限

- 各希望期間にはシフト希望の提出期限が設定される。
- 期限を過ぎた希望は、原則として集計対象外とするが、
  運営判断で取り込むかどうかを決める余地を残す。

## 業務制約2：希望の整合性

- 同一営業日に対して、ひとりのメンバーが複数の矛盾した希望を出してはならない。
  - 例：同じ営業日に「行ける」「行けない」の両方を登録することはできない。
- 時間帯の部分的な参加（前半のみ／後半のみ）を許可するかどうかはイベント方針による。

# BDD例

## 業務ルール1：希望期間に対するシフト希望提出

**シナリオ1: 12月通常営業分のシフト希望を提出する**

```

Given: テナント「シトロン」にイベント「シトロンヴェール」が存在する
And: 2025-12月の通常営業日が4回登録されている
And: 2025-12月通常営業分の希望期間が設定され、
提出期限が2025-11-29 23:59である
And: メンバーMはキャストとして在籍している
When: メンバーMが4回分の営業日に対し、
「すべて出勤可能」である旨のシフト希望を提出する
Then: メンバーMのシフト希望が
4営業日分の「出勤可能」として登録される
And: 希望期間の提出数としてカウントされる

```

# PdM確認事項

## 確認項目1：部分参加の扱い

- 営業時間の一部のみ出勤可能な場合（前半のみなど）を
  - 許可するか
  - 営業全体単位でしか扱わないか
  を仕様として決める必要がある。
  PDM回答：初期スコープでは前半などの一部出勤は対応しない。したことないから
