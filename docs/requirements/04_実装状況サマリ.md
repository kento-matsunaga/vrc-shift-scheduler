# 実装状況サマリ

> 最終更新: 2025-12-19

## 1. 実装状況一覧

### 1.1 バックエンド

#### ドメインモデル

| コンポーネント | 実装状況 | ファイル | 備考 |
|---------------|---------|---------|------|
| Event（イベント） | ✅ 完了 | `domain/event/event.go` | 集約ルート、定期パターン対応 |
| EventBusinessDay（営業日） | ✅ 完了 | `domain/event/event_business_day.go` | エンティティ |
| RecurringPattern（定期パターン） | ✅ 完了 | `domain/event/recurring_pattern.go` | 曜日ベース定期設定 |
| Member（メンバー） | ✅ 完了 | `domain/member/member.go` | ロール紐付け対応 |
| Role（ロール） | ✅ 完了 | `domain/role/role.go` | テナント別カスタム定義 |
| Position（ポジション） | ✅ 完了 | `domain/shift/position.go` | エンティティ |
| ShiftSlot（シフト枠） | ✅ 完了 | `domain/shift/shift_slot.go` | エンティティ |
| ShiftTemplate（シフトテンプレート） | ✅ 完了 | `domain/shift/template.go` | 営業枠テンプレート |
| ShiftAssignment（シフト割り当て） | ✅ 完了 | `domain/shift/shift_assignment.go` | 直接割り当て対応 |
| Admin（管理者） | ✅ 完了 | `domain/auth/admin.go` | JWT認証対応 |
| Tenant（テナント） | ✅ 完了 | `domain/tenant/tenant.go` | マルチテナント |
| AttendanceCollection（出欠確認） | ✅ 完了 | `domain/attendance/` | トークンベース公開ページ |
| DateSchedule（日程調整） | ✅ 完了 | `domain/schedule/` | トークンベース公開ページ |
| Notification（通知） | ⚠️ DB定義のみ | - | 将来実装予定 |
| AuditLog（監査ログ） | ⚠️ DB定義のみ | - | 将来実装予定 |
| Availability（シフト希望） | ❌ 未実装 | - | 将来実装予定 |

#### リポジトリ

| リポジトリ | 実装状況 | 備考 |
|-----------|---------|------|
| EventRepository | ✅ 完了 | CRUD + 定期設定 |
| BusinessDayRepository | ✅ 完了 | CRUD + 月次取得 |
| MemberRepository | ✅ 完了 | CRUD + ロール紐付け |
| RoleRepository | ✅ 完了 | CRUD |
| PositionRepository | ✅ 完了 | CRUD |
| ShiftSlotRepository | ✅ 完了 | CRUD + 割り当て数取得 |
| ShiftTemplateRepository | ✅ 完了 | CRUD |
| ShiftAssignmentRepository | ✅ 完了 | CRUD + 複雑なクエリ |
| AdminRepository | ✅ 完了 | 認証用 |
| AttendanceRepository | ✅ 完了 | 公開トークン対応 |
| ScheduleRepository | ✅ 完了 | 公開トークン対応 |

#### REST API

| エンドポイント | メソッド | 実装状況 |
|---------------|---------|---------|
| **認証** | | |
| `/api/v1/auth/login` | POST | ✅ |
| `/api/v1/auth/logout` | POST | ✅ |
| `/api/v1/auth/token` | POST | ✅ |
| `/api/v1/auth/invitation` | GET/POST | ✅ |
| **イベント** | | |
| `/api/v1/events` | POST | ✅ |
| `/api/v1/events` | GET | ✅ |
| `/api/v1/events/{event_id}` | GET | ✅ |
| `/api/v1/events/{event_id}` | PUT | ✅ |
| `/api/v1/events/{event_id}` | DELETE | ✅ |
| `/api/v1/events/{event_id}/business-days` | POST | ✅ |
| `/api/v1/events/{event_id}/business-days` | GET | ✅ |
| **営業日** | | |
| `/api/v1/business-days/{business_day_id}` | GET | ✅ |
| `/api/v1/business-days/{business_day_id}` | PUT | ✅ |
| `/api/v1/business-days/{business_day_id}` | DELETE | ✅ |
| `/api/v1/business-days/{business_day_id}/shift-slots` | POST | ✅ |
| `/api/v1/business-days/{business_day_id}/shift-slots` | GET | ✅ |
| **シフト枠** | | |
| `/api/v1/shift-slots/{slot_id}` | GET | ✅ |
| `/api/v1/shift-slots/{slot_id}` | PUT | ✅ |
| `/api/v1/shift-slots/{slot_id}` | DELETE | ✅ |
| **シフトテンプレート** | | |
| `/api/v1/events/{event_id}/shift-templates` | POST | ✅ |
| `/api/v1/events/{event_id}/shift-templates` | GET | ✅ |
| `/api/v1/shift-templates/{template_id}` | GET | ✅ |
| `/api/v1/shift-templates/{template_id}` | PUT | ✅ |
| `/api/v1/shift-templates/{template_id}` | DELETE | ✅ |
| `/api/v1/shift-templates/{template_id}/apply` | POST | ✅ |
| **メンバー** | | |
| `/api/v1/members` | POST | ✅ |
| `/api/v1/members` | GET | ✅ |
| `/api/v1/members/{member_id}` | GET | ✅ |
| `/api/v1/members/{member_id}` | PUT | ✅ |
| `/api/v1/members/{member_id}` | DELETE | ✅ |
| **ロール** | | |
| `/api/v1/roles` | POST | ✅ |
| `/api/v1/roles` | GET | ✅ |
| `/api/v1/roles/{role_id}` | GET | ✅ |
| `/api/v1/roles/{role_id}` | PUT | ✅ |
| `/api/v1/roles/{role_id}` | DELETE | ✅ |
| **シフト割り当て** | | |
| `/api/v1/shift-assignments` | POST | ✅ |
| `/api/v1/shift-assignments` | GET | ✅ |
| `/api/v1/shift-assignments/{assignment_id}` | GET | ✅ |
| `/api/v1/shift-assignments/{assignment_id}` | PUT | ✅ |
| `/api/v1/shift-assignments/{assignment_id}` | DELETE | ✅ |
| `/api/v1/shift-assignments/{assignment_id}/cancel` | POST | ✅ |
| **出欠確認** | | |
| `/api/v1/attendance-collections` | POST | ✅ |
| `/api/v1/attendance-collections` | GET | ✅ |
| `/api/v1/attendance-collections/{id}` | GET | ✅ |
| `/api/v1/attendance-collections/{id}` | PUT | ✅ |
| `/api/v1/attendance-collections/{id}` | DELETE | ✅ |
| `/public/attendance/{token}` | GET | ✅ |
| `/public/attendance/{token}/respond` | POST | ✅ |
| **日程調整** | | |
| `/api/v1/date-schedules` | POST | ✅ |
| `/api/v1/date-schedules` | GET | ✅ |
| `/api/v1/date-schedules/{id}` | GET | ✅ |
| `/api/v1/date-schedules/{id}` | PUT | ✅ |
| `/api/v1/date-schedules/{id}` | DELETE | ✅ |
| `/public/schedule/{token}` | GET | ✅ |
| `/public/schedule/{token}/respond` | POST | ✅ |

### 1.2 フロントエンド

#### ページ

| ページ | 実装状況 | ファイル | 機能 |
|-------|---------|---------|------|
| ログイン | ✅ 完了 | `pages/Login.tsx` | JWT認証 |
| イベント一覧 | ✅ 完了 | `pages/Events.tsx` | 一覧表示、作成 |
| 営業日一覧 | ✅ 完了 | `pages/BusinessDays.tsx` | 月次カレンダー表示 |
| シフト枠管理 | ✅ 完了 | `pages/ShiftSlots.tsx` | 一覧表示、作成 |
| シフト割り当て | ✅ 完了 | `pages/AssignShift.tsx` | メンバー選択、確定 |
| メンバー一覧 | ✅ 完了 | `pages/Members.tsx` | 一覧表示、作成、ロール割り当て |
| ロール管理 | ✅ 完了 | `pages/Roles.tsx` | 一覧表示、作成 |
| 出欠確認管理 | ✅ 完了 | `pages/AttendanceManagement.tsx` | 管理画面 |
| 日程調整管理 | ✅ 完了 | `pages/ScheduleManagement.tsx` | 管理画面 |
| 公開出欠回答 | ✅ 完了 | `pages/PublicAttendance.tsx` | トークンURL |
| 公開日程回答 | ✅ 完了 | `pages/PublicSchedule.tsx` | トークンURL |

### 1.3 データベース

#### テーブル

| テーブル | 作成済み | 使用状況 |
|---------|---------|---------|
| tenants | ✅ | ✅ 使用中 |
| admins | ✅ | ✅ 使用中 |
| events | ✅ | ✅ 使用中 |
| recurring_patterns | ✅ | ✅ 使用中 |
| event_business_days | ✅ | ✅ 使用中 |
| members | ✅ | ✅ 使用中 |
| roles | ✅ | ✅ 使用中 |
| member_roles | ✅ | ✅ 使用中 |
| positions | ✅ | ✅ 使用中 |
| shift_slot_templates | ✅ | ✅ 使用中 |
| shift_slots | ✅ | ✅ 使用中 |
| shift_plans | ✅ | ⚠️ 簡易使用 |
| shift_assignments | ✅ | ✅ 使用中 |
| attendance_collections | ✅ | ✅ 使用中 |
| attendance_responses | ✅ | ✅ 使用中 |
| date_schedules | ✅ | ✅ 使用中 |
| candidate_dates | ✅ | ✅ 使用中 |
| date_schedule_responses | ✅ | ✅ 使用中 |
| notification_logs | ✅ | ❌ 未使用 |
| notification_templates | ✅ | ❌ 未使用 |
| audit_logs | ✅ | ❌ 未使用 |

---

## 2. 機能別実装状況

```
[========================================] イベント管理       100%
[========================================] 営業日管理         100%
[========================================] シフト枠管理       100%
[========================================] シフトテンプレート  100%
[========================================] シフト割り当て     100%
[========================================] メンバー管理       100%
[========================================] ロール管理         100%
[========================================] 出欠確認           100%
[========================================] 日程調整           100%
[========================================] 認証・認可         100%
[                                        ] シフト希望           0%
[                                        ] 通知                 0%
[                                        ] 監査ログ             0%
[======                                  ] テナント管理        15%
```

---

## 3. 今後の実装予定

### 高優先度

- [ ] 通知機能（Discord Webhook連携）
- [ ] 監査ログの自動記録

### 中優先度

- [ ] シフト希望機能
- [ ] 定期パターンからの営業日自動生成
- [ ] シフト自動割り当て

### 低優先度

- [ ] テナント管理画面
- [ ] レポート・分析機能
- [ ] Discord OAuth連携

---

## 4. 技術的負債

### 4.1 優先度高

| 項目 | 説明 | 影響 |
|------|------|------|
| 通知機能の実装 | 現在は通知なし | 運用効率低下 |
| 監査ログの実装 | 現在は記録なし | 追跡困難 |

### 4.2 優先度中

| 項目 | 説明 | 影響 |
|------|------|------|
| テストカバレッジ | 一部ドメインモデルのテスト不足 | 品質リスク |
| バリデーションメッセージ | 英語メッセージ混在 | UX |

### 4.3 優先度低

| 項目 | 説明 | 影響 |
|------|------|------|
| OpenAPI Spec | ドキュメント未作成 | 開発効率 |
| フロントエンドテスト | コンポーネントテスト不足 | 品質 |

---

## 5. ディレクトリ構成

```
vrc-shift-scheduler/
├── backend/
│   ├── cmd/
│   │   ├── server/           # HTTPサーバー
│   │   ├── migrate/          # マイグレーション
│   │   └── seed/             # シードデータ
│   └── internal/
│       ├── domain/           # ドメインモデル
│       │   ├── attendance/   # 出欠確認
│       │   ├── auth/         # 認証
│       │   ├── common/       # 共通型
│       │   ├── event/        # イベント関連
│       │   ├── member/       # メンバー関連
│       │   ├── role/         # ロール
│       │   ├── schedule/     # 日程調整
│       │   ├── shift/        # シフト関連
│       │   └── tenant/       # テナント
│       ├── app/              # アプリケーションサービス
│       ├── infra/
│       │   └── db/           # リポジトリ実装
│       │       └── migrations/ # SQLマイグレーション
│       └── interface/
│           └── rest/         # RESTハンドラー
├── web-frontend/
│   └── src/
│       ├── pages/            # ページコンポーネント
│       ├── components/       # 共通コンポーネント
│       ├── lib/              # APIクライアント
│       └── types/            # 型定義
└── docs/
    ├── domain/               # ドメインドキュメント
    └── requirements/         # 要件定義
```
