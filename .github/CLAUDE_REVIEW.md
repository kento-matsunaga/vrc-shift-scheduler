# Claude Code Review Instructions

このファイルは `@claude review` コマンドで実行されるレビュー指示を定義します。

## レビュー観点

### 1. Backend: DDD 原則の遵守

以下の点を確認してください：

- **レイヤー分離**: Domain -> Application -> Infrastructure -> Interface の依存方向が正しいか
- **リポジトリパターン**: Usecase から DB 直接アクセスがないか
- **ドメインロジック**: ビジネスロジックが Domain 層に適切に配置されているか
- **依存性注入**: インターフェースを通じた依存が行われているか
- **エンティティ**: ドメインエンティティが貧血モデルになっていないか

```
backend/
├── internal/
│   ├── domain/          # エンティティ、リポジトリインターフェース（外部依存なし）
│   ├── application/     # ユースケース（domain のみ依存）
│   ├── infra/           # DB実装、外部サービス（domain, application に依存）
│   └── interface/       # HTTPハンドラー（全層に依存可能）
```

### 2. Frontend: 既存デザインとの整合性

以下の点を確認してください：

- **UIコンポーネント**: 既存のデザインパターンに従っているか
- **Tailwind CSS**: 既存クラス命名規則との一貫性
- **レスポンシブ対応**: モバイル/デスクトップ両方で適切に表示されるか
- **カラースキーム**: 既存の色使いと調和しているか
- **インタラクション**: ボタン、フォーム等の挙動が統一されているか

### 3. Frontend-Backend 疎通

以下の点を確認してください：

- **API エンドポイント**: 正しいエンドポイントを呼び出しているか
- **リクエスト/レスポンス型**: TypeScript 型定義と Backend の JSON 構造が一致しているか
- **エラーハンドリング**: API エラーが適切に処理されているか
- **認証ヘッダー**: JWT トークンが正しく送信されているか
- **テナント分離**: X-Tenant-ID ヘッダーが必要な箇所で送信されているか
- **例外的な繋ぎ込み**: ハードコードされた値やワークアラウンドがないか

### 4. モック/一時的実装の検出

以下のパターンを検出してください：

- `// TODO`, `// FIXME`, `// HACK` コメント
- ハードコードされたテストデータ
- `console.log` デバッグ出力
- コメントアウトされたコード
- `any` 型の使用（TypeScript）
- 空の catch ブロック
- モックデータを返す関数
- 未実装のエラーハンドリング（`panic`, `throw new Error("not implemented")` など）

## レビュー出力形式

レビュー結果は以下の形式で出力してください：

```markdown
## Code Review Summary

### DDD 原則
- [ ] レイヤー分離: （問題なし / 問題あり: 詳細）
- [ ] リポジトリパターン: （問題なし / 問題あり: 詳細）
- [ ] ドメインロジック配置: （問題なし / 問題あり: 詳細）

### デザイン整合性
- [ ] UI パターン: （問題なし / 問題あり: 詳細）
- [ ] スタイル一貫性: （問題なし / 問題あり: 詳細）

### API 疎通
- [ ] エンドポイント: （問題なし / 問題あり: 詳細）
- [ ] 型定義: （問題なし / 問題あり: 詳細）
- [ ] エラーハンドリング: （問題なし / 問題あり: 詳細）

### 一時的実装
- [ ] TODO/FIXME: （なし / あり: 箇所）
- [ ] モックデータ: （なし / あり: 箇所）
- [ ] デバッグコード: （なし / あり: 箇所）

### 総合評価
（Approve / Request Changes / Comment のみ）

### 詳細コメント
（具体的な改善提案があればここに記載）
```

## 注意事項

- レビューは建設的に行い、具体的な改善案を提示すること
- 軽微なスタイルの違いは指摘しないこと
- セキュリティに関わる問題は必ず指摘すること
- パフォーマンスに影響する変更は言及すること
